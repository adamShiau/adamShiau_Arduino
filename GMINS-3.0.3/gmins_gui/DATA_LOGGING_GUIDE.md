# GMINS GUI 數據記錄功能說明

## ✅ 已實現功能

### 📊 每5秒自動數據記錄
- **功能**: GUI會自動每5秒在DataLog中顯示收到的串口數據
- **格式**: 十六進制格式，例如 `FE 81 FF 55 87 27 AC 3A 8E E6...`
- **位置**: 在GUI右側的 "📝 Data Log" 標籤頁中顯示

### 🔗 真實串口連接
- **端口檢測**: 自動檢測可用的COM端口
- **實時連接**: 使用SerialManager進行真實的串口通信
- **數據接收**: 實時接收並緩存串口數據

## 📋 數據記錄格式

### 正常數據記錄
```
[14:25:30] 📊 Data (32 bytes): FE 81 FF 55 87 27 AC 3A 8E E6 E6 3A 40 63 5A BB 8A 11 AC BD 71 D7 41 BD 64 57 1C C1 41 D4 00 00
```

### 無數據時的記錄
```
[14:25:35] 📊 No data received in last 5 seconds
```

### 連接狀態變化
```
[14:25:20] 🔗 Connected to COM3 at 230400 baud
[14:25:25] ✅ Connected successfully to COM3 - USB Serial Device!
```

## 🎮 使用方法

### 1. 啟動GUI
```bash
cd C:\Users\user\.aaproject\GMINS\gmins_gui
python main.py
```

### 2. 連接設備
1. 確保GMINS設備已連接到電腦
2. 在GUI左側選擇正確的COM端口
3. 選擇協議模式（AR1AFC/MAVLink/Auto-detect）
4. 選擇波特率（230400/460800/115200）
5. 點擊 "Connect" 按鈕

### 3. 查看數據記錄
1. 連接成功後，切換到右側的 "📝 Data Log" 標籤
2. 系統會每5秒自動記錄收到的數據
3. 數據以十六進制格式顯示，每個字節用空格分隔

### 4. 發送命令
- 使用左側的快捷按鈕（AR1AFC Mode, MAVLink Mode等）
- 或在"Custom Command"輸入框中輸入自定義命令

## 🔧 技術實現

### 數據流程
1. **數據接收**: SerialManager接收串口數據 → 觸發`data_received`信號
2. **數據緩存**: 數據存儲在`received_data_buffer`中
3. **定時記錄**: 每5秒的定時器觸發`log_received_data()`
4. **格式化顯示**: 數據轉換為十六進制格式並顯示在DataLog中

### 關鍵組件
- `SerialManager`: 串口通信管理
- `data_log_timer`: 5秒定時器
- `received_data_buffer`: 數據緩存
- `log_received_data()`: 數據記錄函數

## 📊 數據分析

### 數據包示例分析
```
FE 81 FF 55 87 27 AC 3A 8E E6 E6 3A 40 63 5A BB 8A 11 AC BD 71 D7 41 BD 64 57 1C C1 41 D4 00 00
```

- **總長度**: 32 bytes
- **可能的協議**: AR1AFC 或 MAVLink 數據包
- **數據格式**: 二進制傳感器數據，需要根據協議規範進行解析

## ⚡ 性能特點

- **低延遲**: 100ms UI更新間隔
- **高效緩存**: 數據緩存避免丟失
- **自動清理**: 記錄後自動清空緩存
- **智能波特率**: 根據協議自動切換波特率

## 🚨 注意事項

1. **數據格式**: 目前以原始十六進制顯示，如需解析需要額外的解碼器
2. **緩存大小**: 每5秒清空一次緩存，避免內存累積
3. **連接狀態**: 只有在連接狀態下才會記錄數據
4. **自動滾動**: DataLog會自動滾動到最新記錄

## 🔧 故障排除

### 沒有數據顯示
1. 檢查設備是否正確連接
2. 確認COM端口是否正確
3. 檢查波特率設置
4. 嘗試刷新端口列表

### 連接失敗
1. 確保設備驅動已安裝
2. 檢查端口是否被其他應用程序占用
3. 嘗試不同的波特率
4. 重新插拔設備

---

**版本**: 1.0.0  
**最後更新**: 2025-09-05  
**狀態**: ✅ 已實現並可用